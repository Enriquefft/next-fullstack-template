---
description: Generate UI implementation specifications for a feature based on spec.md and brand.md
---

## User Input

```text
$ARGUMENTS
```

You **MUST** consider the user input before proceeding (if not empty).

## Outline

1. **Check prerequisites**:
   - Run `.specify/scripts/bash/check-prerequisites.sh --json --require-spec` from repo root
   - Parse FEATURE_DIR from output
   - Verify spec.md exists in FEATURE_DIR
   - Check if brand.md exists in project root (warn if missing, proceed with shadcn defaults)

2. **Load context**:
   - **REQUIRED**: Read FEATURE_DIR/spec.md for feature requirements
   - **REQUIRED**: Read brand.md from project root for visual patterns
   - **IF MISSING brand.md**: Use shadcn/ui defaults and note in output

3. **Analyze spec.md** and extract:

   **Screens**: Identify every distinct view/page from user stories
   ```
   For each user story, ask:
   - What screen does the user see?
   - What state is the screen in?
   - What can the user do here?
   - Where do they go next?
   ```

   **Components**: Identify UI elements needed
   ```
   - Forms → Input, Label, Button, form validation patterns
   - Lists → Card, Table, empty states
   - Actions → Button variants, confirmation dialogs
   - Feedback → Alert, Toast, loading states
   - Navigation → Links, breadcrumbs, tabs
   ```

   **States**: For each screen, identify all states
   ```
   - Default: Normal content display
   - Loading: Data being fetched
   - Empty: No data to display
   - Error: Something went wrong
   - Success: Action completed (if applicable)
   - Partial: Some data loaded, some loading
   ```

   **Flows**: Map user journeys
   ```
   Screen A → Action → Screen B
   ```

4. **Generate design.md** in FEATURE_DIR with this structure:

```markdown
# Design: {Feature Name}

> UI specifications for implementation.
> Generated by /speckit.design on {date}.
> Reference: brand.md for component patterns.

## Screens

### 1. {Screen Name}

**Purpose**: {What this screen does}

**Entry Points**: 
- {How users get here}

**Layout**:
\`\`\`
{ASCII representation or description}
┌─────────────────────────────┐
│ Header                      │
├─────────────────────────────┤
│                             │
│    Main Content Area        │
│                             │
├─────────────────────────────┤
│ Footer/Actions              │
└─────────────────────────────┘
\`\`\`

**Container**: `{tailwind classes for page container}`

**Components Used**:
| Component | Variant/Props | Notes |
|-----------|---------------|-------|
| Button | `variant="default"` | Primary CTA |
| Input | with Label | Email field |
| Alert | `variant="destructive"` | Error display |

**States**:

| State | Trigger | Visual Changes |
|-------|---------|----------------|
| Default | Page load with data | Show content |
| Loading | Initial fetch | Skeleton or spinner |
| Empty | No data returned | Empty state pattern from brand.md |
| Error | Fetch failed | Error alert, retry button |

**Exit Points**:
- {Where users can go from here}

---

### 2. {Next Screen}
{Repeat structure}

---

## Component Specifications

### {ComponentName}

**Base**: `{shadcn component}` from brand.md

**Customizations**:
\`\`\`tsx
// Specific usage for this feature
<Component 
  className="{any additional classes}"
  {props}
/>
\`\`\`

**States**:
- Default: {description}
- {Other states specific to this feature}

---

## User Flows

### {Flow Name}

\`\`\`
[Screen A] 
    │
    │ User action: {clicks button}
    ▼
[Screen B / State change]
    │
    │ User action: {submits form}
    ▼
[Screen C / Success state]
\`\`\`

**Error Paths**:
- If {condition}: Show {error state}
- If {condition}: Redirect to {screen}

---

## Form Specifications

### {Form Name}

**Fields**:

| Field | Type | Validation | Error Message |
|-------|------|------------|---------------|
| email | Input type="email" | Required, valid email | "Please enter a valid email" |
| password | Input type="password" | Required, min 8 chars | "Password must be at least 8 characters" |

**Submit Button**:
- Default: "{Label}"
- Loading: "{Loading label}" with spinner
- Disabled: When form invalid

**Success Behavior**: {What happens on success}

**Error Behavior**: {What happens on error}

---

## Responsive Behavior

| Breakpoint | Layout Changes |
|------------|----------------|
| Mobile (default) | {description} |
| Tablet (md:) | {description} |
| Desktop (lg:) | {description} |

---

## Accessibility Notes

- {Any specific a11y considerations}
- {Required ARIA labels}
- {Keyboard navigation requirements}

---

## Implementation Checklist

### Screens
- [ ] {Screen 1}
- [ ] {Screen 2}
- [ ] {Screen 3}

### States
- [ ] Loading states for all async operations
- [ ] Empty states for all lists/data displays
- [ ] Error states with recovery options
- [ ] Success feedback for all actions

### Forms
- [ ] Validation on blur and submit
- [ ] Error messages displayed
- [ ] Loading state on submit
- [ ] Success/error feedback

### Responsive
- [ ] Mobile layout tested
- [ ] Tablet layout tested
- [ ] Desktop layout tested
```

5. **Cross-reference with brand.md**:
   - For each component in design.md, verify it has a pattern in brand.md
   - If using a component not in brand.md, include full code snippet in design.md
   - Reference brand.md sections by name (e.g., "See brand.md > State Patterns > Loading")

6. **Validate completeness**:
   - Every screen from spec.md has a design
   - Every screen has all states defined
   - Every form has validation and error handling
   - Every action has feedback (loading, success, error)

7. **Output summary**:
   ```
   ✓ Created design.md
   
   Design Summary:
   ─────────────────
   Screens:    {count}
   Components: {count}
   Forms:      {count}
   States:     {count} total
   
   Screens:
   1. {Screen Name} ({state count} states)
   2. {Screen Name} ({state count} states)
   ...
   
   Next steps:
   - Review design.md for accuracy
   - Run /speckit.plan to create technical architecture
   ```

## Design Principles

When generating design.md, follow these principles:

### Completeness Over Brevity
- Include ALL screens, even simple ones
- Include ALL states, even if they seem obvious
- Include ALL validation rules

### Reference, Don't Duplicate
- Reference brand.md patterns instead of copying code
- Only include code snippets for feature-specific customizations
- Say "See brand.md > Component Patterns > Button" instead of copying the Button pattern

### Implementation-Ready
- Every specification should be directly implementable
- No ambiguity - if something could be interpreted two ways, specify which
- Include exact Tailwind classes, not descriptions like "make it centered"

### State Coverage
Every screen must address:
1. What does the user see initially? (Loading or Default)
2. What if there's no data? (Empty)
3. What if something fails? (Error)
4. What if it succeeds? (Success, if applicable)

### Form Handling
Every form must specify:
1. All fields with types and validation
2. Error message text
3. Submit button states (default, loading, disabled)
4. Success behavior
5. Error behavior

## Notes

- design.md is for human consumption and Claude's implementation context
- It bridges the gap between requirements (spec.md) and code
- If brand.md doesn't exist, warn but proceed with shadcn/ui defaults
- The implementation checklist helps track progress during /speckit.implement
